function [MMM,c]=computemoment(param,thomsen,typeofmedia,vel)
kk=typeofmedia;
delta=param(2)*pi/180;
phi=param(1)*pi/180;
lamda=param(3)*pi/180;
alpha=param(4)*pi/180;

theta=param(5)*pi/180;
phi1=param(6)*pi/180;

M1=zeros(6,6);
M1(1,1)=cos(theta)^2;
M1(1,3)=sin(theta)^2;
M1(1,5)=-sin(2*theta);
M1(2,2)=1;
M1(3,1)=sin(theta)^2;
M1(3,3)=cos(theta)^2;
M1(3,5)=sin(2*theta);
M1(4,4)=cos(theta);
M1(4,6)=sin(theta);
M1(5,1)=0.5*sin(2*theta);
M1(5,3)=-0.5*sin(2*theta);
M1(5,5)=cos(2*theta);
M1(6,4)=-sin(theta);
M1(6,6)=cos(theta);

M2=zeros(6,6);
M2(1,1)=cos(phi1)^2;
M2(1,2)=sin(phi1)^2;
M2(1,6)=-sin(2*phi1);
M2(2,1)=sin(phi1)^2;
M2(2,2)=cos(phi1)^2;
M2(2,6)=sin(2*phi1);
M2(3,3)=1;
M2(4,4)=cos(phi1);
M2(4,5)=sin(phi1);
M2(5,4)=-sin(phi1);
M2(5,5)=cos(phi1);
M2(6,1)=0.5*sin(2*phi1);
M2(6,2)=-0.5*sin(2*phi1);
M2(6,6)=cos(2*phi1);

n1=-sin(delta)*sin(phi);
n2=sin(delta)*cos(phi);
n3=-cos(delta);
v1=(cos(lamda)*cos(phi)+cos(delta)*sin(lamda)*sin(phi))*cos(alpha)-sin(delta)*sin(phi)*sin(alpha);
v2=(cos(lamda)*sin(phi)-cos(delta)*sin(lamda)*cos(phi))*cos(alpha)+sin(delta)*cos(phi)*sin(alpha);
v3=-sin(lamda)*sin(delta)*cos(alpha)-cos(delta)*sin(alpha);
%n=[n1,n2,n3];
%v=[v1,v2,v3];
M=zeros(3,3);
M(1,1)=n1*v1;
M(1,2)=n1*v2+n2*v1;
M(1,3)=n1*v3+n3*v1;
M(2,1)=M(1,2);
M(3,1)=M(1,3);
M(2,2)=n2*v2;
M(2,3)=n2*v3+n3*v2;
M(3,2)=M(2,3);
M(3,3)=n3*v3;
MM=[M(1,1),M(2,2),M(3,3),M(2,3),M(1,3),M(1,2)]';
Vp=vel(1);
Vs=vel(2);
Den_g=vel(3);
Ug=Vs*Vs*Den_g;
Mg=Vp*Vp*Den_g;
Kg=Mg-4/3*Ug;
c=zeros(6,6);
if(kk==0)
c(1,1)=Mg;
c(1,2)=Kg-2/3*Ug;
c(1,3)=Kg-2/3*Ug;
c(2,2)=Mg;
c(2,3)=Kg-2/3*Ug;
c(3,3)=Mg;
c(2,1)=c(1,2);
c(3,1)=c(1,3);
c(3,2)=c(2,3);
c(4,4)=Ug;
c(5,5)=Ug;
c(6,6)=Ug;
else
    kesi=thomsen(1);
    ga=thomsen(2);
    deltasi=thomsen(3);
    c(3,3)=Vp*Vp*Den_g;
    c(1,1)=(2*kesi+1)*c(3,3);
    c(5,5)=Vs*Vs*Den_g;
    c(4,4)=c(5,5);
    c(6,6)=(2*ga+1)*c(4,4);
    c(1,2)=c(1,1)-2*c(6,6);
    c(1,3)=sqrt(2*c(3,3)*(c(3,3)-c(4,4))*deltasi+(c(3,3)-c(4,4))^2)-c(4,4);
    c(2,2)=c(1,1);
    c(2,3)=c(1,3);
    c(2,1)=c(1,2);
    c(3,1)=c(1,3);
    c(3,2)=c(2,3);
    c=M2*M1*c*M1'*M2';
end
Mo1=c(1,:)*MM;
Mo2=c(2,:)*MM;
Mo3=c(3,:)*MM;
Mo4=c(4,:)*MM;
Mo5=c(5,:)*MM;
Mo6=c(6,:)*MM;

MMM=[Mo1,Mo6,Mo5;Mo6,Mo2,Mo4;Mo5,Mo4,Mo3];
end