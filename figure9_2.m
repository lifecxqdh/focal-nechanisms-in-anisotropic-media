clear
% close all
%% 定义震源与检波器
source=[0,0,0];
X=linspace(-1000,1000,11);
receivers=zeros(length(X),3);
receivers(:,1)=1000;
receivers(:,2)=0;
receivers(:,3)=X;
retoso=receivers-source;
%% 介质参数
vel=[3000,1731,1800];
distance=sqrt((retoso(:,1).^2+retoso(:,2).^2+retoso(:,3).^2));
dt=0.001;
lastt=1.0;
fre=50;
t1=distance/(vel(1)*dt);
t2=distance/(vel(2)*dt);
TT=floor(1/(fre*dt));
typeofmedia=0;% isotropic=0, anisotropic=other;
thomsen=[0.346,0.28,-0.05];% Thomesn parameters;
bond=[0,0]; %  Polarization angle and azimuth
dismodel=[30,45,60];% strike, slip and rake
% slope=[-90,-45,-22.5,-10,0,10,22.5,45,90];
split=0;
aaaa=[45,45,90,90];
bbbb=[1,1,1,1];
slope=[0,90,0,90];
kk=length(aaaa);
type=['TTI';'TTI';'HTI';'HTI'];
for ii=1:kk
bond=[aaaa(ii),0];
typeofmedia=bbbb(ii);
param=[dismodel(1),dismodel(2),dismodel(3),slope(ii),bond(1),bond(2)];
[M,c]=computemoment(param,thomsen,typeofmedia,vel);
if(typeofmedia==0)
    medium='isotropic';
else
    medium='anisotropic';
end
isotype=0;
%% 计算地震记录
for i=1:length(X)
    [U,~,~]=anasolu(isotype,fre,retoso(i,:),vel,dt,lastt,M,split);
    Ux(i,:)=U(1,:);
    Uy(i,:)=U(2,:);
    Uz(i,:)=U(3,:);
end
t=0:dt:lastt;
x=(1:length(retoso));
subplot(2,2,ii)
wiggle(x,t,Uz','VA2')
view(-90,90)
xlabel('Receivers','Fontname','Times New Roman', 'Fontsize',14);
ylabel('Time (s)','Fontname','Times New Roman', 'Fontsize',14);
text(length(X)+0.5,0.05,['slope=',num2str(param(4)),'^{\circ}',type(ii,:)],'FontSize',18,'Fontname','Times New Roman')
xlim([0 length(X)+1])
end
 annotation(gcf,'textbox',...
    [0.088 0.888 0.035 0.037],...
    'String',{'(a)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Times New Roman');
annotation(gcf,'textbox',...
    [0.533 0.888 0.035 0.037],...
    'String',{'(b)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Times New Roman');
annotation(gcf,'textbox',...
    [0.088 0.402 0.035 0.037],...
    'String',{'(c)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Times New Roman');
annotation(gcf,'textbox',...
    [0.533 0.402 0.035 0.037],...
    'String',{'(d)'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FontName','Times New Roman');
set(gcf,'Position',[318 188 1357 834])
annotation(gcf,'ellipse',...
    [0.311 0.296 0.064 0.057],...
    'Color',[1 0 0],...
    'LineWidth',1.25);
annotation(gcf,'ellipse',...
    [0.311 0.769 0.064 0.057],...
    'Color',[1 0 0],...
    'LineWidth',1.25);
annotation(gcf,'ellipse',...
    [0.7604 0.654 0.064 0.057],...
    'Color',[0 0 1],...
    'LineWidth',1.25);
annotation(gcf,'ellipse',...
    [0.7604 0.180 0.064 0.057],...
    'Color',[0 0 1],...
    'LineWidth',1.25);